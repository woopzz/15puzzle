var k="0123456789ABCDEF",h="F",_=class{constructor(n,t=[]){this.state=n,this.path=t,this.blankTileIndex=n.indexOf(h)}canBeMoved(n){return n<0||n>15?!1:n-4===this.blankTileIndex||n+4===this.blankTileIndex||n-1===this.blankTileIndex&&n%4!==0||n+1===this.blankTileIndex&&n%4!==3}move(n){let t=this.blankTileIndex<n?this.blankTileIndex:n,o=this.blankTileIndex>n?this.blankTileIndex:n;return new _(this.state.slice(0,t)+this.state[o]+this.state.slice(t+1,o)+this.state[t]+this.state.slice(o+1),[...this.path,n])}};function p(e){return e.state===k}function B(e){let n=N(e)&1,t=q(e)&1;return!!(n^t)}function N(e){let n=e.state.indexOf(h);return 4-Math.floor(n/4)}function q(e){let n=0;for(let t=0;t<e.state.length-1;t++)for(let o=t+1;o<e.state.length;o++)e.state[t]!==h&&e.state[o]!==h&&e.state[t]>e.state[o]&&n++;return n}var T=class{constructor(n){this.board=n}execute(){for(;this.shuffle(),!(B(this.board)&&!p(this.board)););return this.board}shuffle(){let n=Array.from(this.board.state);for(let t=n.length-1;t>0;t--){let o=Math.floor(Math.random()*t),r=n[t];n[t]=n[o],n[o]=r}this.board=new _(n.join(""))}};var c,l=new Array(128).fill(void 0);l.push(void 0,null,!0,!1);function a(e){return l[e]}var y=l.length;function H(e){e<132||(l[e]=y,y=e)}function $(e){let n=a(e);return H(e),n}var I=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&I.decode();var g=null;function E(){return(g===null||g.byteLength===0)&&(g=new Uint8Array(c.memory.buffer)),g}function x(e,n){return e=e>>>0,I.decode(E().subarray(e,e+n))}function u(e){y===l.length&&l.push(l.length+1);let n=y;return y=l[n],l[n]=e,n}function O(e){let n=typeof e;if(n=="number"||n=="boolean"||e==null)return`${e}`;if(n=="string")return`"${e}"`;if(n=="symbol"){let r=e.description;return r==null?"Symbol":`Symbol(${r})`}if(n=="function"){let r=e.name;return typeof r=="string"&&r.length>0?`Function(${r})`:"Function"}if(Array.isArray(e)){let r=e.length,s="[";r>0&&(s+=O(e[0]));for(let i=1;i<r;i++)s+=", "+O(e[i]);return s+="]",s}let t=/\[object ([^\]]+)\]/.exec(toString.call(e)),o;if(t.length>1)o=t[1];else return toString.call(e);if(o=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:o}var L=0,A=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},z=typeof A.encodeInto=="function"?function(e,n){return A.encodeInto(e,n)}:function(e,n){let t=A.encode(e);return n.set(t),{read:e.length,written:t.length}};function v(e,n,t){if(t===void 0){let f=A.encode(e),b=n(f.length,1)>>>0;return E().subarray(b,b+f.length).set(f),L=f.length,b}let o=e.length,r=n(o,1)>>>0,s=E(),i=0;for(;i<o;i++){let f=e.charCodeAt(i);if(f>127)break;s[r+i]=f}if(i!==o){i!==0&&(e=e.slice(i)),r=t(r,o,o=i+e.length*3,1)>>>0;let f=E().subarray(r+i,r+o),b=z(e,f);i+=b.written,r=t(r,o,i,1)>>>0}return L=i,r}var w=null;function S(){return(w===null||w.byteLength===0)&&(w=new Int32Array(c.memory.buffer)),w}var R=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>{c.__wbindgen_export_2.get(e.dtor)(e.a,e.b)});function V(e,n,t,o){let r={a:e,b:n,cnt:1,dtor:t},s=(...i)=>{r.cnt++;try{return o(r.a,r.b,...i)}finally{--r.cnt===0&&(c.__wbindgen_export_2.get(r.dtor)(r.a,r.b),r.a=0,R.unregister(r))}};return s.original=r,R.register(s,r,r),s}function P(e,n){c._dyn_core__ops__function__Fn_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h585df4d0fdfea316(e,n)}var m=null;function J(){return(m===null||m.byteLength===0)&&(m=new Uint32Array(c.memory.buffer)),m}function K(e,n){return e=e>>>0,J().subarray(e/4,e/4+n)}function W(e){try{let r=c.__wbindgen_add_to_stack_pointer(-16),s=v(e,c.__wbindgen_malloc,c.__wbindgen_realloc),i=L;c.autosolve(r,s,i);var n=S()[r/4+0],t=S()[r/4+1],o=K(n,t).slice();return c.__wbindgen_free(n,t*4,4),o}finally{c.__wbindgen_add_to_stack_pointer(16)}}function C(){c.start()}function M(e){return e==null}function d(e,n){try{return e.apply(this,n)}catch(t){c.__wbindgen_exn_store(u(t))}}async function G(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(o){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}let t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{let t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}function Q(){let e={};return e.wbg={},e.wbg.__wbindgen_object_drop_ref=function(n){$(n)},e.wbg.__wbindgen_string_new=function(n,t){let o=x(n,t);return u(o)},e.wbg.__wbg_instanceof_Window_f401953a2cf86220=function(n){let t;try{t=a(n)instanceof Window}catch{t=!1}return t},e.wbg.__wbg_document_5100775d18896c16=function(n){let t=a(n).document;return M(t)?0:u(t)},e.wbg.__wbg_body_edb1908d3ceff3a1=function(n){let t=a(n).body;return M(t)?0:u(t)},e.wbg.__wbg_querySelector_a5f74efc5fa193dd=function(){return d(function(n,t,o){let r=a(n).querySelector(x(t,o));return M(r)?0:u(r)},arguments)},e.wbg.__wbg_instanceof_HtmlElement_3bcc4ff70cfdcba5=function(n){let t;try{t=a(n)instanceof HTMLElement}catch{t=!1}return t},e.wbg.__wbg_setonclick_4fd9bd8531d33a17=function(n,t){a(n).onclick=a(t)},e.wbg.__wbindgen_object_clone_ref=function(n){let t=a(n);return u(t)},e.wbg.__wbg_log_5bb5f88f245d7762=function(n){console.log(a(n))},e.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(n,t){let o=new Function(x(n,t));return u(o)},e.wbg.__wbg_call_27c0f87801dedf93=function(){return d(function(n,t){let o=a(n).call(a(t));return u(o)},arguments)},e.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return d(function(){let n=self.self;return u(n)},arguments)},e.wbg.__wbg_window_c6fb939a7f436783=function(){return d(function(){let n=window.window;return u(n)},arguments)},e.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return d(function(){let n=globalThis.globalThis;return u(n)},arguments)},e.wbg.__wbg_global_207b558942527489=function(){return d(function(){let n=global.global;return u(n)},arguments)},e.wbg.__wbindgen_is_undefined=function(n){return a(n)===void 0},e.wbg.__wbindgen_debug_string=function(n,t){let o=O(a(t)),r=v(o,c.__wbindgen_malloc,c.__wbindgen_realloc),s=L;S()[n/4+1]=s,S()[n/4+0]=r},e.wbg.__wbindgen_throw=function(n,t){throw new Error(x(n,t))},e.wbg.__wbindgen_closure_wrapper50=function(n,t,o){let r=V(n,t,5,P);return u(r)},e}function X(e,n){return c=e.exports,D.__wbindgen_wasm_module=n,w=null,m=null,g=null,c}async function D(e){if(c!==void 0)return c;typeof e>"u"&&(e=new URL("wasm_15puzzle_bg.wasm",import.meta.url));let n=Q();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));let{instance:t,module:o}=await G(await e,n);return X(t,o)}var F=D;var Y=new Map([["1","0"],["2","1"],["3","2"],["4","3"],["5","4"],["6","5"],["7","6"],["8","7"],["9","8"],["10","9"],["11","A"],["12","B"],["13","C"],["14","D"],["15","E"],["0","F"]]),Z=new Map([["0","1"],["1","2"],["2","3"],["3","4"],["4","5"],["5","6"],["6","7"],["7","8"],["8","9"],["9","10"],["A","11"],["B","12"],["C","13"],["D","14"],["E","15"],["F","0"]]);function ee(e,n){let t=document.querySelector(".field"),o=document.querySelector(".won-msg"),r=t.children;for(let s=0;s<e.state.length;s++){let i=r[s];i.dataset.number=Z.get(e.state[s]),i.style.backgroundColor=""}if(n.length){let s=r[n.at(-1)];s.style.backgroundColor="#bbb"}o.style.display=p(e)?"block":"none"}var U=()=>new T(new _(k,[])).execute();function j(){let e=U(),n=[],t=()=>ee(e,n);document.querySelector(".field").addEventListener("click",function(o){let r=o.target;if(!r.classList.contains("box"))return;let s=Y.get(r.dataset.number);if(s===void 0)return;let i=e.state.indexOf(s);e.canBeMoved(i)&&(e=e.move(i)),n.length&&(e.path.length&&e.path.at(-1)===n.at(-1)?n.pop():n=[]),t()}),document.querySelector(".hint").addEventListener("click",function(){n=Array.from(W(e.state)).reverse(),t()}),document.querySelector(".shuffle").addEventListener("click",function(){e=U(),n=[],t()}),C(),t()}F().then(()=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",j):j()});
